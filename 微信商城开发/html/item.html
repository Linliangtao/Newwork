
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>详情页</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.bootcss.com/weui/1.1.2/style/weui.min.css">
    <link rel="stylesheet" href="https://cdn.bootcss.com/jquery-weui/1.2.0/css/jquery-weui.min.css">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/swiper.min.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/item.css">
    <link rel="stylesheet" href="css/theme-color.css">
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<header class="zyw-header">
    <div class="zyw-container white-color">
        <div class="head-l"><a href="javascript:window.history.back(-1)" target="_self"><img src="img/svg/head-return.svg" alt=""></a></div>
        <h1><a href="#" class="active">商品</a><a href="#item-precent">详情</a><a href="#comm">评价</a></h1>
        <div class="head-r"><img src="img/svg/head-more.svg" alt=""></div>
    </div>
</header>
<footer class="zyw-footer">
    <div class="zyw-container white-bgcolor clearfix">
        <div class="col-sm-2 col-xs-2">
            <a href="cart.html" class="weui-tabbar__item">
                <span class="weui-badge" style="position: absolute;top: -.4em;right: 1em;">2</span>
                <div class="weui-tabbar__icon">
                    <img src="./img/svg/item-2.svg" alt="">
                </div>
                <p class="weui-tabbar__label">购物车</p>
            </a>
        </div>
        <div class="col-sm-5 col-xs-5">
            <a href="" class="footer-btn footer-warning">立即购买</a>
        </div>
        <div class="col-sm-5 col-xs-5">
            <a href="" class="footer-btn footer-danger">加入购物车</a>
        </div>
    </div>
</footer>
<section class="zyw-container">
    <!-- Swiper -->
    <div class="item-img">
        <div class="swiper-wrapper">
            
        </div>
        <!-- Add Pagination -->
        <div class="swiper-pagination"></div>
    </div>
    <div class="item-details white-bgcolor clearfix">
        <h3 class="details-title"></h3>
        <strong class="details-prince theme-color pull-left">￥<span class="good_price"></span></strong>
        <span class="details-volume pull-right">月销：<span id="dv"></span>件</span>
    </div>
    <div class="item-choose weui-cells mt-625">
        <a class="weui-cell weui-cell_access open-popup" href="javascript:;" data-target="#item_spec">
            <div class="weui-cell__bd">
                <p class="choose-text">选择 <span>颜色分类</span></p>
            </div>
            <div class="weui-cell__ft choose-des">
            </div>
        </a>
        <div id="item_spec" class="weui-popup__container popup-bottom">
            <div class="weui-popup__overlay"></div>
            <div class="weui-popup__modal">
                <div class="item-spec-layer white-bgcolor">
                    <div class="spec-head clearfix">
                        <div class="spec-head-img"><img src="" alt=""></div>
                        <strong class="spec-head-prince theme-color">￥<span class="good_price"></span></strong>
                        <p class="spec-head-intro">商品编号：<span id="gnum"></span></p>
                    </div>
                    <div class="spec-info clearfix">
                        <div class="spec-info-hd">颜色</div>
                        <div class="spec-info-bd">
                            <ul id="colors">
                                
                            </ul>
                        </div>
                    </div>
                    <div class="spec-info clearfix">
                        <div class="spec-info-hd">版本</div>
                        <div class="spec-info-bd">
                            <ul id="models">
                                
                            </ul>
                        </div>
                    </div>
                    <div class="spec-length mb-625">
                        <div class="weui-cell__bd">
                            <p class="length-hd">数量</p>
                        </div>
                        <div class="weui-cell__ft">
                            <div class="weui-count">
                                <a class="weui-count__btn weui-count__decrease"></a>
                                <input class="weui-count__number" type="number" value="1">
                                <a class="weui-count__btn weui-count__increase"></a>
                            </div>
                        </div>
                    </div>
                    <button class="item-layer-button theme-bgcolor white-color" type="submit">确定</button>
                    <a href="javascript:;" class="close-popup spec-close"><i class="fa fa-close"></i></a>
                </div>
            </div>
        </div>
        <a class="weui-cell weui-cell_access open-popup" href="javascript:;" data-target="#item_parameter">
            <div class="weui-cell__bd">
                <p class="choose-text">产品参数</p>
            </div>
            <div class="weui-cell__ft choose-des">
            </div>
        </a>
        <div id="item_parameter" class="weui-popup__container popup-bottom">
            <div class="weui-popup__overlay"></div>
            <div class="weui-popup__modal">
                <div class="item-parameter-layer white-bgcolor">
                    <h3 class="parameter-title">产品参数</h3>
                    <div id="params">
                    </div>
                    <button class="item-layer-button theme-bgcolor white-color close-popup" type="submit">完成</button>
                </div>
            </div>
        </div>
    </div>
    <span id="comm"></span>
    <div class="item-serve">
        <span><i class="fa fa-check-circle-o theme-color"></i> 品质承诺</span>
        <span><i class="fa fa-check-circle-o theme-color"></i> 七天包退换</span>
        <span><i class="fa fa-check-circle-o theme-color"></i> 如实描述</span>
    </div>
    <div class="item-assess weui-cells mb-625">
        <a class="weui-cell weui-cell_access" href="javascript:;">
            <div class="weui-cell__bd">
                <p class="choose-text">用户评价（<em class="theme-color comm_num">0</em>条）</p>
            </div>
            <div class="weui-cell__ft choose-des">
                100%好评
            </div>
        </a>
    </div>
    <div class="item-precent white-bgcolor" id="item-precent">
        <h4>图文详情</h4>
        <div id="intro">
        </div>
    </div>
</section>
<script src="https://cdn.bootcss.com/jquery/1.11.0/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/jquery-weui/1.2.0/js/jquery-weui.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/swiper.min.js"></script>
<script>
    var baseurl='/t/api/';//API接口基础地址
    var id=GF('id');//获取商品ID

    $(function(){
        $.getJSON(baseurl,{ac:'get_goods',id:id},function(r,s){
            if(s!='success'){
                alert('调用接口失败');
                return ;
            }
            document.title = r.title + ' - 详细页';//页面标题
            $('.details-title').text(r.title);//商品标题
            $('#dv').text(r.dv);//月销量

            //商品图片
            var imgs = '';
            $.each(r.imgs,function(i,its){
                imgs += '<div class="swiper-slide"><img src="' + its.img + '" alt="' + its.title + '" title="' + its.title + '"></div>';
            });
            $('.item-img .swiper-wrapper').html(imgs);
            var swiper = new Swiper('.item-img', {
                autoplay:true,
                delay: 5000,
                slidesPerView: 1,
                spaceBetween: 0,
                keyboard: {
                    enabled: true,
                },
                pagination: {
                    el: '.swiper-pagination',
                    type: 'fraction',
                },
            });
            //颜色分类，不同颜色，不同型号，价格、商品编号、图片等不一样
            color = '';//颜色
            model = '';//型号/版本
            $.each(r.items,function(i,its){
                $('.spec-head-img img').attr('src',its.img);
                color += '<li' + ((i==0)?' class="active"':'') + '>' + its.name + '</li>';
                if(i==0){//第一条记录
                    $.each(its.models,function(mi,mits){
                        if(mi==0){//第一条记录
                            $('.good_price').text(mits.price);//商品价格
                            $('#gnum').text(mits.gnum);//商品编号
                        }
                        model += '<li' + ((mi==0)?' class="active"':'') + '>' + mits.name + '</li>';
                    });
                }
            });
            $('#colors').html(color);
            $('#models').html(model);

            //商品参数
            $('#params').html(r.params);

            //用户评论条数
            $('.comm_num').text(r.comm_num);

            //图文详情
            $('#intro').html(r.intro);

        });
    });
    var MAX = 10, MIN = 1;
    $('.weui-count__decrease').click(function (e) {
        var $input = $(e.currentTarget).parent().find('.weui-count__number');
        var number = parseInt($input.val() || "0") - 1
        if (number < MIN) number = MIN;
        $input.val(number)
    });
    $('.weui-count__increase').click(function (e) {
        var $input = $(e.currentTarget).parent().find('.weui-count__number');
        var number = parseInt($input.val() || "0") + 1
        if (number > MAX) number = MAX;
        $input.val(number)
    });
</script>
</body>
</html>